{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\Ui/assets\\Script\\Ui\\BallView.js"],"names":["signals","SignalMgr","cc","Class","extends","Component","properties","initPosition","direction","RigidBody","onLoad","node","position","getComponent","that","bind","listen","onEnter","onLeave","moveLeaveAction","moveTo","stopAllActions","runAction","console","info","v2","view","getVisibleSize","height","linearVelocity","on","event","offset","rate","getRoot","y","x","loader","loadRes","url","raw","err","clip","audioEngine","playEffect","start","onBeginContact","contact","self","other","dispose","tag","update","dt","width"],"mappings":"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","file":"BallView.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Ui","sourcesContent":["import SignalMgr from \"../Signal/SignalMgr\";\r\nvar signals = new SignalMgr();\r\n// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        //初始位置\r\n        initPosition: 0,\r\n        direction : 0,\r\n        RigidBody : null,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.initPosition = this.node.position;\r\n        this.RigidBody = this.getComponent(cc.RigidBody);\r\n        var that = this;\r\n\r\n        signals.bind(\"start\").listen(function () {\r\n            onEnter();\r\n        });\r\n        signals.bind(\"over\").listen(function () {\r\n            onLeave();\r\n        });\r\n\r\n        function onLeave() {\r\n            let moveLeaveAction = cc.moveTo(1, that.initPosition, 0);\r\n            that.node.stopAllActions();\r\n            that.node.runAction(moveLeaveAction);\r\n            console.info(\"[on leave]\");\r\n        }\r\n\r\n        function onEnter() {\r\n            //let moveEnterAction = cc.moveTo(1, cc.v2(that.node.position.x, that.node.position.y - 200), 0);\r\n            that.node.stopAllActions();\r\n            //that.node.runAction(moveEnterAction);\r\n            that.node.position = cc.v2(0,cc.view.getVisibleSize().height/2);//初始化位置\r\n            that.getComponent(cc.RigidBody).linearVelocity = cc.v2(0,0);\r\n            console.info(\"[on enter]\");\r\n        }\r\n\r\n/*         this.node.on(\"touchmove\", (event) => {\r\n            //将世界坐标转化为本地坐标\r\n            let touchPoint = this.node.parent.convertToNodeSpaceAR(event.getLocation());\r\n            let delta = event.touch.getDelta();\r\n            console.info(\"[触摸位置]\" + touchPoint + \"[变化]\"+delta);\r\n            this.node.x = touchPoint.x;\r\n            this.node.y = touchPoint.y;\r\n            this.RigidBody.linearVelocity = cc.v2(25 * delta.x,0);\r\n        }); */\r\n\r\n        this.node.on(\"touchstart\", (event) => {\r\n            var offset = 0;\r\n            var rate = 1;\r\n            this.direction = signals.getRoot().direction;\r\n            if(this.RigidBody.linearVelocity.y<0){\r\n                offset = 0;\r\n                rate = 0.25;\r\n            }\r\n            if(this.direction===0){\r\n                this.RigidBody.linearVelocity = cc.v2(this.RigidBody.linearVelocity.x - 100,rate * this.RigidBody.linearVelocity.y + 325 + offset);\r\n            }\r\n            if(this.direction===1){\r\n                this.RigidBody.linearVelocity = cc.v2(this.RigidBody.linearVelocity.x + 100,rate * this.RigidBody.linearVelocity.y + 325 + offset);\r\n            }\r\n\r\n            cc.loader.loadRes(cc.url.raw(\"resources/Audio/00B9_0008.wav\"), function (err, clip) {\r\n                cc.audioEngine.playEffect(clip,false);\r\n            });\r\n        });\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n    onBeginContact(contact, self, other) {\r\n        //console.info(\"[Contact]\"+other.tag);\r\n        //发布碰撞消息\r\n        signals.dispose(\"contact\",other.tag);\r\n    },\r\n    update (dt) {\r\n        if(this.node.x > 50 + cc.view.getVisibleSize().width/2){\r\n            this.node.x = -25 - cc.view.getVisibleSize().width/2;\r\n            this.node.y = this.node.y / 4;\r\n            this.RigidBody.linearVelocity = cc.v2( 150 ,350);\r\n        }\r\n        if(this.node.x < -50 -cc.view.getVisibleSize().width/2){\r\n            this.node.x =  25 + cc.view.getVisibleSize().width/2\r\n            this.node.y = this.node.y / 4;\r\n            this.RigidBody.linearVelocity = cc.v2( -150 ,350);\r\n        }\r\n        if(this.direction === 0 && this.RigidBody.linearVelocity.x > -50 ){\r\n            this.RigidBody.linearVelocity = cc.v2( this.RigidBody.linearVelocity.x - 0.1 , this.RigidBody.linearVelocity.y);\r\n        }\r\n        if(this.direction === 1 && this.RigidBody.linearVelocity.x < 50 ){\r\n            this.RigidBody.linearVelocity = cc.v2( this.RigidBody.linearVelocity.x + 0.1 , this.RigidBody.linearVelocity.y);\r\n        }\r\n        if(this.node.y < -100 -cc.view.getVisibleSize().height/2){\r\n            this.node.x = 0;\r\n            this.node.y = cc.view.getVisibleSize().height/2;\r\n        }\r\n    },\r\n});\r\n"]}